(function(l,o){typeof exports=="object"&&typeof module<"u"?o(exports):typeof define=="function"&&define.amd?define(["exports"],o):(l=typeof globalThis<"u"?globalThis:l||self,o(l.underlog={}))})(this,function(l){"use strict";var T=Object.defineProperty;var $=(l,o,h)=>o in l?T(l,o,{enumerable:!0,configurable:!0,writable:!0,value:h}):l[o]=h;var a=(l,o,h)=>($(l,typeof o!="symbol"?o+"":o,h),h);const o=require("dayjs");class h{getTimestamp(){return o().format()}}class m{constructor(t){a(this,"level");a(this,"levelOnly");this.level=Object.freeze(t.level),this.levelOnly=Object.freeze(t.levelOnly)}tryGetData(t){let e={dataAsString:"",dataRaw:[],hasData:!1};const s=t.args||[];if(e.hasData=s.length>0,s.length>0){e.dataRaw=s;try{return Array.isArray(s)?e.dataAsString=s.join(", "):e.dataAsString=JSON.stringify(s),e}catch{return e.dataAsString=s.join(", "),e}}return e}}class p extends m{constructor(t){super(t)}async write(t){return new Promise(e=>{const{timestamp:s,level:i,args:n}=t,r=`${s} ${i}`;n?console.log(`${r}:`,...n):console.log(r),e(!0)})}}class y extends m{constructor(e){super(e);a(this,"prefix",Object.freeze("%c "));a(this,"levelStyles",{log:"background: blue; color: white",highlight:"background: yellow;",debug:"background: blue; color: white",info:"background: green; color: white",warn:"background: orange; color: white",["warn-high"]:"font-size: 20px; background: orange; color: white",error:"background: red; color: white"});e.levelStyles&&(this.levelStyles=Object.freeze(e.levelStyles))}async write(e){return new Promise(s=>{const{timestamp:i,level:n}=e,{dataAsString:r,hasData:c}=this.tryGetData(e);let u=!1;if(navigator&&(u=/chrome/gi.test(navigator.userAgent)),n!=="log"&&u){const g=`${i}${this.prefix+n}`.trim();c?console.log(`${g}:`,this.levelStyles[n],r):console.log(`${g}:`,this.levelStyles[n])}else{const g=`${i} ${n}`.trim();c?console.log(`${g}:`,r):console.log(g)}s(!0)})}}class S extends m{constructor(e){super(e);a(this,"domElement");a(this,"levelStyles",{log:"color: black",highlight:"background-color: yellow; color: black",debug:"color: blue",info:"color: green",warn:"color: orange",["warn-high"]:"font-size: 20px; background: orange; color: white",error:"color: red"});this.domElement=e.domElement,e.levelStyles&&(this.levelStyles=Object.freeze(e.levelStyles))}async write(e){return new Promise((s,i)=>{if(!this.domElement||this.domElement.innerHTML===void 0)i("HtmlTransport: write: Invalid or undefined dom element");else{const{timestamp:n,level:r}=e,{dataAsString:c,hasData:u}=this.tryGetData(e),g=`<span>${n}</span>`;let v="";r!=="log"?v=`<span style="${this.levelStyles[r]}">${r}</span>`:v=`<span>${r}</span>`;let d=`${g} ${v}`;u?d=`${d}: <span>${c}</span><br/>`:d=`${d}<br/>`,this.domElement.innerHTML+=d,s(!0)}})}}class w extends m{constructor(e){super(e);a(this,"prefix",Object.freeze("\x1B["));a(this,"suffix",Object.freeze("\x1B[0;37m"));a(this,"levelStyles",{log:"0;1;37m",highlight:"7;1;36m",debug:"0;1;34m",info:"0;1;32m",warn:"0;1;33m",["warn-high"]:"0;1;35m",error:"0;1;31m"});e.levelStyles&&(this.levelStyles=Object.freeze(e.levelStyles))}async write(e){return new Promise(s=>{const{timestamp:i,level:n}=e,r=`${i} ${this.prefix}${this.levelStyles[n]}${n}${this.suffix}:`,c=e.args||[];c.length>0?console.log(`${r}:`,...c):console.log(r),s(!0)})}}class b{constructor(t){a(this,"supportedLevels");a(this,"transports");a(this,"timestampService");if(t){const{levels:e,transports:s,timestampService:i}=t;this.initLevels(e),this.initTransports(s),this.initTimestampService(i)}else this.initLevels(),this.initTransports(),this.initTimestampService()}timestamp(){return this.timestampService?this.timestampService.getTimestamp():new Date().toString()}initLevels(t){const e=["highlight","debug"];(t||[]).length>0?this.supportedLevels=[...e,...t]:this.supportedLevels=e}initTransports(t){(t||[]).length>0?this.transports=t:this.transports=[new p({level:"error",levelOnly:!1})]}initTimestampService(t){t?this.timestampService=t:this.timestampService=new h}async canProceed(t){return new Promise(e=>{let s=!1;const{transportLevel:i,transportLevelOnly:n,level:r}=t;if(n)s=i===r;else if(i===r||["log","highlight"].indexOf(r)>-1)s=!0;else{const c=this.supportedLevels,u=c.indexOf(i);u>1&&(s=c.slice(0,u).includes(r))}e(s)})}async transportsWrite(t){return new Promise(e=>{this.transports.forEach(async s=>{if(await this.canProceed({transportLevel:s.level,transportLevelOnly:s.levelOnly,level:t.level})){const n=await s.write(t);e(n)}})})}log(...t){let e="log",s=[];(t||[]).length>0&&(e=t.shift(),t.length>0&&(s=t));const i={timestamp:this.timestamp(),level:e,args:s};this.transportsWrite(i).then(()=>{})}highlight(...t){this.log(t)}debug(...t){this.log(t)}info(...t){this.log(t)}warn(...t){this.log(t)}error(...t){this.log(t)}}l.BaseTransport=m,l.ChromeTransport=y,l.DayJsTimestampService=h,l.DefaultTransport=p,l.HtmlTransport=S,l.Logger=b,l.StdErrTransport=w,Object.defineProperties(l,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
