(function(v,L){typeof exports=="object"&&typeof module<"u"?L(exports):typeof define=="function"&&define.amd?define(["exports"],L):(v=typeof globalThis<"u"?globalThis:v||self,L(v.underlog={}))})(this,function(v){"use strict";var he=Object.defineProperty;var de=(v,L,C)=>L in v?he(v,L,{enumerable:!0,configurable:!0,writable:!0,value:C}):v[L]=C;var j=(v,L,C)=>de(v,typeof L!="symbol"?L+"":L,C);var L=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function C(b){return b&&b.__esModule&&Object.prototype.hasOwnProperty.call(b,"default")?b.default:b}var R={exports:{}};(function(b,i){(function(n,a){b.exports=a()})(L,function(){var n=1e3,a=6e4,f=36e5,g="millisecond",d="second",y="minute",M="hour",D="day",O="week",w="month",Q="quarter",x="year",P="date",K="Invalid Date",le=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,ue=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,ce={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(o){var r=["th","st","nd","rd"],e=o%100;return"["+o+(r[(e-20)%10]||r[e]||r[0])+"]"}},U=function(o,r,e){var s=String(o);return!s||s.length>=r?o:""+Array(r+1-s.length).join(e)+o},fe={s:U,z:function(o){var r=-o.utcOffset(),e=Math.abs(r),s=Math.floor(e/60),t=e%60;return(r<=0?"+":"-")+U(s,2,"0")+":"+U(t,2,"0")},m:function o(r,e){if(r.date()<e.date())return-o(e,r);var s=12*(e.year()-r.year())+(e.month()-r.month()),t=r.clone().add(s,w),l=e-t<0,u=r.clone().add(s+(l?-1:1),w);return+(-(s+(e-t)/(l?t-u:u-t))||0)},a:function(o){return o<0?Math.ceil(o)||0:Math.floor(o)},p:function(o){return{M:w,y:x,w:O,d:D,D:P,h:M,m:y,s:d,ms:g,Q}[o]||String(o||"").toLowerCase().replace(/s$/,"")},u:function(o){return o===void 0}},W="en",H={};H[W]=ce;var X="$isDayjsObject",G=function(o){return o instanceof B||!(!o||!o[X])},N=function o(r,e,s){var t;if(!r)return W;if(typeof r=="string"){var l=r.toLowerCase();H[l]&&(t=l),e&&(H[l]=e,t=l);var u=r.split("-");if(!t&&u.length>1)return o(u[0])}else{var h=r.name;H[h]=r,t=h}return!s&&t&&(W=t),t||!s&&W},$=function(o,r){if(G(o))return o.clone();var e=typeof r=="object"?r:{};return e.date=o,e.args=arguments,new B(e)},c=fe;c.l=N,c.i=G,c.w=function(o,r){return $(o,{locale:r.$L,utc:r.$u,x:r.$x,$offset:r.$offset})};var B=function(){function o(e){this.$L=N(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[X]=!0}var r=o.prototype;return r.parse=function(e){this.$d=function(s){var t=s.date,l=s.utc;if(t===null)return new Date(NaN);if(c.u(t))return new Date;if(t instanceof Date)return new Date(t);if(typeof t=="string"&&!/Z$/i.test(t)){var u=t.match(le);if(u){var h=u[2]-1||0,m=(u[7]||"0").substring(0,3);return l?new Date(Date.UTC(u[1],h,u[3]||1,u[4]||0,u[5]||0,u[6]||0,m)):new Date(u[1],h,u[3]||1,u[4]||0,u[5]||0,u[6]||0,m)}}return new Date(t)}(e),this.init()},r.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},r.$utils=function(){return c},r.isValid=function(){return this.$d.toString()!==K},r.isSame=function(e,s){var t=$(e);return this.startOf(s)<=t&&t<=this.endOf(s)},r.isAfter=function(e,s){return $(e)<this.startOf(s)},r.isBefore=function(e,s){return this.endOf(s)<$(e)},r.$g=function(e,s,t){return c.u(e)?this[s]:this.set(t,e)},r.unix=function(){return Math.floor(this.valueOf()/1e3)},r.valueOf=function(){return this.$d.getTime()},r.startOf=function(e,s){var t=this,l=!!c.u(s)||s,u=c.p(e),h=function(z,T){var _=c.w(t.$u?Date.UTC(t.$y,T,z):new Date(t.$y,T,z),t);return l?_:_.endOf(D)},m=function(z,T){return c.w(t.toDate()[z].apply(t.toDate("s"),(l?[0,0,0,0]:[23,59,59,999]).slice(T)),t)},p=this.$W,S=this.$M,k=this.$D,Y="set"+(this.$u?"UTC":"");switch(u){case x:return l?h(1,0):h(31,11);case w:return l?h(1,S):h(0,S+1);case O:var A=this.$locale().weekStart||0,I=(p<A?p+7:p)-A;return h(l?k-I:k+(6-I),S);case D:case P:return m(Y+"Hours",0);case M:return m(Y+"Minutes",1);case y:return m(Y+"Seconds",2);case d:return m(Y+"Milliseconds",3);default:return this.clone()}},r.endOf=function(e){return this.startOf(e,!1)},r.$set=function(e,s){var t,l=c.p(e),u="set"+(this.$u?"UTC":""),h=(t={},t[D]=u+"Date",t[P]=u+"Date",t[w]=u+"Month",t[x]=u+"FullYear",t[M]=u+"Hours",t[y]=u+"Minutes",t[d]=u+"Seconds",t[g]=u+"Milliseconds",t)[l],m=l===D?this.$D+(s-this.$W):s;if(l===w||l===x){var p=this.clone().set(P,1);p.$d[h](m),p.init(),this.$d=p.set(P,Math.min(this.$D,p.daysInMonth())).$d}else h&&this.$d[h](m);return this.init(),this},r.set=function(e,s){return this.clone().$set(e,s)},r.get=function(e){return this[c.p(e)]()},r.add=function(e,s){var t,l=this;e=Number(e);var u=c.p(s),h=function(S){var k=$(l);return c.w(k.date(k.date()+Math.round(S*e)),l)};if(u===w)return this.set(w,this.$M+e);if(u===x)return this.set(x,this.$y+e);if(u===D)return h(1);if(u===O)return h(7);var m=(t={},t[y]=a,t[M]=f,t[d]=n,t)[u]||1,p=this.$d.getTime()+e*m;return c.w(p,this)},r.subtract=function(e,s){return this.add(-1*e,s)},r.format=function(e){var s=this,t=this.$locale();if(!this.isValid())return t.invalidDate||K;var l=e||"YYYY-MM-DDTHH:mm:ssZ",u=c.z(this),h=this.$H,m=this.$m,p=this.$M,S=t.weekdays,k=t.months,Y=t.meridiem,A=function(T,_,J,F){return T&&(T[_]||T(s,l))||J[_].slice(0,F)},I=function(T){return c.s(h%12||12,T,"0")},z=Y||function(T,_,J){var F=T<12?"AM":"PM";return J?F.toLowerCase():F};return l.replace(ue,function(T,_){return _||function(J){switch(J){case"YY":return String(s.$y).slice(-2);case"YYYY":return c.s(s.$y,4,"0");case"M":return p+1;case"MM":return c.s(p+1,2,"0");case"MMM":return A(t.monthsShort,p,k,3);case"MMMM":return A(k,p);case"D":return s.$D;case"DD":return c.s(s.$D,2,"0");case"d":return String(s.$W);case"dd":return A(t.weekdaysMin,s.$W,S,2);case"ddd":return A(t.weekdaysShort,s.$W,S,3);case"dddd":return S[s.$W];case"H":return String(h);case"HH":return c.s(h,2,"0");case"h":return I(1);case"hh":return I(2);case"a":return z(h,m,!0);case"A":return z(h,m,!1);case"m":return String(m);case"mm":return c.s(m,2,"0");case"s":return String(s.$s);case"ss":return c.s(s.$s,2,"0");case"SSS":return c.s(s.$ms,3,"0");case"Z":return u}return null}(T)||u.replace(":","")})},r.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},r.diff=function(e,s,t){var l,u=this,h=c.p(s),m=$(e),p=(m.utcOffset()-this.utcOffset())*a,S=this-m,k=function(){return c.m(u,m)};switch(h){case x:l=k()/12;break;case w:l=k();break;case Q:l=k()/3;break;case O:l=(S-p)/6048e5;break;case D:l=(S-p)/864e5;break;case M:l=S/f;break;case y:l=S/a;break;case d:l=S/n;break;default:l=S}return t?l:c.a(l)},r.daysInMonth=function(){return this.endOf(w).$D},r.$locale=function(){return H[this.$L]},r.locale=function(e,s){if(!e)return this.$L;var t=this.clone(),l=N(e,s,!0);return l&&(t.$L=l),t},r.clone=function(){return c.w(this.$d,this)},r.toDate=function(){return new Date(this.valueOf())},r.toJSON=function(){return this.isValid()?this.toISOString():null},r.toISOString=function(){return this.$d.toISOString()},r.toString=function(){return this.$d.toUTCString()},o}(),ee=B.prototype;return $.prototype=ee,[["$ms",g],["$s",d],["$m",y],["$H",M],["$W",D],["$M",w],["$y",x],["$D",P]].forEach(function(o){ee[o[1]]=function(r){return this.$g(r,o[0],o[1])}}),$.extend=function(o,r){return o.$i||(o(r,B,$),o.$i=!0),$},$.locale=N,$.isDayjs=G,$.unix=function(o){return $(1e3*o)},$.en=H[W],$.Ls=H,$.p={},$})})(R);var te=R.exports;const re=C(te);class Z{getTimestamp(){return re().format()}}class E{constructor(i){j(this,"level");j(this,"levelOnly");this.level=Object.freeze(i.level),this.levelOnly=Object.freeze(i.levelOnly)}tryGetData(i){let n={dataAsString:"",dataRaw:[],hasData:!1,message:""};const a=i.args||[];if(n.hasData=a.length>1,a.length===1)n.message=a[0];else if(a.length>1){n.message=a[0],a.shift(),n.dataRaw=a;try{return Array.isArray(a)?n.dataAsString=a.map(f=>{if(typeof f=="object")try{return JSON.stringify(f)}catch{return f.toString()}else return f.toString()}).join(": "):n.dataAsString=JSON.stringify(a),n}catch{return n.dataAsString=a.join(", "),n}}return n}}class V extends E{constructor(i){super(i)}async write(i){return new Promise(n=>{const{timestamp:a,level:f,args:g}=i,d=`${a} ${f}`;g?console.log(`${d}:`,...g):console.log(d),n(!0)})}}function ne(){return typeof window<"u"&&typeof navigator<"u"}class se extends E{constructor(n){super(n);j(this,"prefix",Object.freeze("%c "));j(this,"levelStyles",{log:"background: blue; color: white",highlight:"background: lightyellow;",debug:"background: blue; color: white",info:"background: green; color: white",warn:"background: orange; color: white",warnhigh:"font-size: 20px; background: orange; color: white",error:"background: red; color: white"});n.levelStyles&&(this.levelStyles=Object.freeze(n.levelStyles))}async write(n){return new Promise(a=>{const{timestamp:f}=n,g=(n.level||"").trim(),{message:d,dataRaw:y,hasData:M}=this.tryGetData(n);let D=!1;if(ne()&&(D=/chrome/gi.test(`${navigator.userAgent||""}`)),g!=="log"&&D){const O=`${f} ${this.prefix+g} ${d}`.trim();M?console.log(`${O}:`,this.levelStyles[g],...y):console.log(`${O}:`,this.levelStyles[g])}else{const O=`${f} ${g} ${d}`.trim();M?console.log(`${O}:`,...y):console.log(O)}a(!0)})}}class ie extends E{constructor(n){super(n);j(this,"domElement");j(this,"levelStyles",{log:"color: black",highlight:"background-color: yellow; color: black",debug:"color: blue",info:"color: green",warn:"color: orange",warnhigh:"font-size: 20px; background: orange; color: white",error:"color: red"});this.domElement=n.domElement,n.levelStyles&&(this.levelStyles=Object.freeze(n.levelStyles))}async write(n){return new Promise((a,f)=>{if(!this.domElement||this.domElement.innerHTML===void 0)f("HtmlTransport: write: Invalid or undefined dom element");else{const{timestamp:g,level:d}=n,{dataAsString:y,hasData:M}=this.tryGetData(n),D=`<span>${g}</span>`;let O="";d!=="log"?O=`<span style="${this.levelStyles[d]}">${d}</span>`:O=`<span>${d}</span>`;let w=`${D} ${O}`;M?w=`${w}: <span>${y}</span><br/>`:w=`${w}<br/>`,this.domElement.innerHTML+=w,a(!0)}})}}class oe extends E{constructor(n){super(n);j(this,"prefix",Object.freeze("\x1B["));j(this,"suffix",Object.freeze("\x1B[0;37m"));j(this,"levelStyles",{log:"0;1;37m",highlight:"7;1;38m",debug:"0;1;34m",info:"0;1;32m",warn:"0;1;33m",warnhigh:"0;1;35m",error:"0;1;31m"});n.levelStyles&&(this.levelStyles=Object.freeze(n.levelStyles))}async write(n){return new Promise(a=>{const{timestamp:f,level:g}=n,d=`${f} ${this.prefix}${this.levelStyles[g]}${g}${this.suffix}:`,y=n.args||[];y.length>0?console.log(`${d}:`,...y):console.log(d),a(!0)})}}const q=Object.freeze(["log","highlight","debug","info","warn","error"]);class ae{constructor(i){j(this,"supportedLevels");j(this,"transports");j(this,"timestampService");if(i){const{levels:n,transports:a,timestampService:f}=i;n&&n.length>0?this.initLevels(n):this.initLevels(),a&&a.length>0?this.initTransports(a):this.initTransports(),f?this.initTimestampService(f):this.initTimestampService()}else this.initLevels(),this.initTransports(),this.initTimestampService()}timestamp(){return this.timestampService?this.timestampService.getTimestamp():new Date().toString()}initLevels(i){const n=i||[];n.length>0?this.supportedLevels=Object.freeze([...n]):this.supportedLevels=Object.freeze([...q])}initTransports(i){(i||[]).length>0?this.transports=i:this.transports=[new V({level:"error",levelOnly:!1})]}initTimestampService(i){i?this.timestampService=i:this.timestampService=new Z}async canProceed(i){return new Promise(n=>{let a=!1;const{transportLevel:f,transportLevelOnly:g}=i,d=(i.level||"").toString().trim().toLowerCase();if(g)a=f===d;else if(f===d||["log","highlight"].indexOf(d)>-1)a=!0;else{const y=this.supportedLevels,M=y.indexOf(f);M>1&&(a=y.slice(0,M).includes(d))}n(a)})}async transportsWrite(i){return new Promise(n=>{this.transports.forEach(async a=>{if(await this.canProceed({transportLevel:a.level,transportLevelOnly:a.levelOnly,level:i.level})){const g=await a.write(i);n(g)}})})}getDefaultLevels(){return q}getSupportedLevels(){return this.supportedLevels}log(...i){let n="log",a=[];if((i||[]).length>0){const g=(i[0]||"").toString().trim().toLowerCase();this.supportedLevels.indexOf(g)>-1?(n=g,i.shift(),i.length>0&&(a=i)):(n="log",a=i)}const f={timestamp:this.timestamp(),level:n,args:a};this.transportsWrite(f).then(()=>{})}highlight(...i){this.log("highlight",...i)}debug(...i){this.log("debug",...i)}info(...i){this.log("info",...i)}warn(...i){this.log("warn",...i)}error(...i){this.log("error",...i)}}v.BaseTransport=E,v.ChromeTransport=se,v.DayJsTimestampService=Z,v.DefaultTransport=V,v.HtmlTransport=ie,v.Logger=ae,v.StdErrTransport=oe,Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})});
